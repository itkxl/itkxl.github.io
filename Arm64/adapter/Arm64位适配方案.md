## 一、背景

- 1、目前32位用户占比仅0.5%；
- 2、当前App依旧使用32位架构，不能发为64位设备性能优势，Vss溢出问题严重；
- 3、小米、OPPO、vivo联合推进64位架构适配，华为支持aab分包方案。

## 二、系统如何兼容32位和64位
安装时仅携带64位so的App无法安装在32位手机设备上，仅携带32位so和32位&64位so都携带的App可以在所有设备安装，安装后32位和64位so会被释放到App不同的文件路径，
跟base.apk同源，只读。

启动时见下图，概括来讲系统会根据安装时解压的so路径是否包含64位名称的路径来觉得是从Zygote64 fork进程还是从Zygote fork进程。换句话说，如果App携带了空的64位abi目录，
安装后系统会误认为此App是支持64位架构的，从而区对应目录找相关的so，如果找不到就会产生崩溃。
![avator](system.png)


## 三、备选方案

|  | 方案 | 优势 | 劣势 
|-------|-------|-------|------|
| 1 | 一个宿主同时包含32位so和64位so | 方便管理；<br> 不影响用户打开App成功率； | 显著增加包体积，与目前so库数量以及大小有关系
| 2 | 32位和64位各一个宿主包 | 不影响包体积； <br> 不影响用户打开成功率； | 所有的出包流程都要改变; <br> 渠道包数量增加；
| 3 | 一个宿主包默认写到64位so，<br> 动态下发32位so | 不影响出包流程 ；<br> 最大化覆盖64位设备用户；| 32位用户设备用户启动需要等待so下载； <br> 需要开发so管理平台，客户端需要对应so管理sdk



### 宿主
### 插件

## 四、最终方案

### so管理后台
### 宿主（基于方案3）
### 插件（服用宿主so管理能力）


## 五、代码